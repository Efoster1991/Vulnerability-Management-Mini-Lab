# Vulnerability Management Mini Lab

![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/75636143-a05d-436b-bf33-9b89deb33595)

## Prepare Vulnerability Management Scanner

1. Go to [Azure Portal](https://portal.azure.com)
2. Navigate to the Marketplace and search for “**OpenVAS secured and supported by HOSSTED**”.
3. Choose “Start with a pre-set configuration” and pick the weakest one.
4. Continue to "Create VM" with the following settings:
   - **Resource Group**: `Vulnerability-Management`
   - **VM Name**: `OpenVAS` (Note the region and Vnet–consider East US 2)
   - **Authentication**: Username `azureuser` / Password `Cyberlab123!`
   - **Monitoring**: Disable Boot Diagnostic.
5. Create the VM by clicking on “Create”.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/c6ce46b1-8fbb-4537-a4f2-2afac7e78f3e)


### SSH into it With PowerShell (Windows)
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/d99d0271-6ce8-4d69-a770-c327dcecad2d)

Use the credentials created earlier to SSH into the VM.

### Vulnerability Scanner Setup

- **Username**: `admin`
- **Password**: `fc1eda78-b4ef-4337-bbf1-2cb72b54f8a9`
- Access the scanner at [https://172.206.56.173.c.hossted.com/](#)
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/a209b18e-d78a-4290-b285-e9f232d67927)

## Create a Vulnerable VM in Azure

1. Go back to [Azure Portal](https://portal.azure.com/).
2. Search for Virtual Machines and create a new Virtual Machine with the following settings:
   - **Resource Group**: `Vulnerability-Management`
   - **VM Name**: `Win10-Vulnerable`
   - **Region**: Same as OpenVAS VM (East US 2)
   - **Virtual Network**: Same as OpenVAS
   - **Image**: Windows 10 Pro
   - **Size**: Any size with 2 vCPUs
   - **Username**: `azureuser` / Password `Cyberlab123!`
   - **Networking**: Ensure it's the same Vnet as OpenVAS.
3. Create the VM.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/c02e4d01-5338-49a3-9242-06c4545568b7)

### Make the VM Vulnerable

- Disable the Windows Firewall.
- Install old software versions:
  - FireFox Setup 97.0b5
  - VLC Player: vlc-1.1.7-win32
  - Adobe Reader: 10.0_AdbeRdr1000_en_US_1_
- Restart the VM.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/eae95313-6c1a-4edf-852f-e40e688bb5df)
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/b3ee28b5-ac1f-4381-8bf9-017be4ab7a36)

## OpenVAS Unauthenticated Scan

1. Log into OpenVAS.
2. Navigate to Assets → Hosts → New Host and add the Client VM PRIVATE IP Address.
3. Create a New Target from the Host, name it “Azure Vulnerable VMs”.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/1b13f137-01f2-4e51-a3a8-3333e7dc5e1d)

## Credentialed Scans Configuration
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/6c31d84f-ad79-4302-bfa4-b8c2dcf3d62c)
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/bd75f21f-191d-4cb5-ab73-48a33b903959)
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/e770f913-ed30-42eb-a0bf-e93accc831cf)

### Within VM

- Disable Windows Firewall.
- Disable User Account Control.
- Enable Remote Registry.
- Set `LocalAccountTokenFilterPolicy` to `1` in the registry.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/2c3d7639-bd3e-44b2-9f22-e2365e463aa9)

### In OpenVAS

- Go to Configuration → Credentials → New Credential:
  - **Name/Comment**: `Azure VM Credentials`
  - **Username**: `azureuser`
  - **Password**: `Cyberlab123!`
- Clone the target for a credentialed scan and associate the new credentials.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/22094c6a-387a-4394-9d0e-b48917c767a0)

## Execute Credentialed Scan

Clone the unauthenticated scan task and modify it for a credentialed scan against the vulnerable VM.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/21ea5149-c5fe-42ae-9c2a-8ee72e2dc6e1)
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/e2fd1cf3-321e-4dde-86a9-f4a24bc4e484)

## Remediate Vulnerabilities

Log back into the Win10-Vulnerable VM, uninstall the outdated software, and restart the VM.

## Verify Remediations

Re-initiate the credentialed scan and observe the results.
![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/e9f01a0b-d281-4648-9e34-00def1972237)

![image](https://github.com/Efoster1991/Vulnerability-Management-Mini-Lab/assets/29463551/1c6a5bde-c108-49c1-8f88-f45cee764c31)

## Images from the Lab

Replace the following placeholders with the actual URLs after you've uploaded the images.

![Image Description 1](URL_TO_IMAGE)
![Image Description 2](URL_TO_IMAGE)
...
